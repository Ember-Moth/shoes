- address: 127.0.0.1:44300
  transport: tcp
  protocol:
    type: shadowtls
    # specify different configs based on ShadowTLS SNI
    sni_targets:

      example.com:
        password: asdf123
        handshake:
          # connect to example.com:443 as the handshake server
          address: example.com:443
          # optionally, use a client proxy for the handshake server connection.
          # specify multiple proxies to load balance.
          client_proxies:
            # direct connection
            - protocol:
                type: direct
            # connect through socks
            - address: 127.0.0.1:5555
              protocol:
                type: socks
                username: internal-socks-user
                password: internal-socks-pass
        protocol:
          type: socks
          username: socks-user
          password: socks-pass

      google.com:
        password: fdsa321
        handshake:
          # connect directly to google.com as the handshake server
          address: google.com:443

    # specify a default target for SNIs that don't match, or if an SNI is not
    # provided. here, we use a local in-process handshake instead of a remote
    # server.
    default_target:
      password: asdf
      handshake:
        cert: cert.pem
        key: cert.pem
      protocol:
        type: http
        username: http-user123
        password: http-password345

  rules:
    - mask: 0.0.0.0/0
      action: allow
      client_proxy: direct
